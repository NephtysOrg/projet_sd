package com.nephtysorg.model.pojo;
// Generated 20 avr. 2015 10:17:30 by Hibernate Tools 4.3.1


import java.util.ArrayList;
import java.util.Collections;
import java.util.HashSet;
import java.util.List;
import java.util.Objects;
import java.util.Set;
import javax.persistence.Transient;
import javax.validation.constraints.Size;

/**
 * Group generated by hbm2java
 */
public class Group  implements java.io.Serializable, java.lang.Comparable {


     private Integer id;
     private User user;
     @Size(min=5, max=20)
     private String name;
     @Size(max=100)
     private String description;
     private Set userGroups = new HashSet(0);

    /**
     *
     */
    public Group() {
    }

    /**
     *
     * @param user
     * @param name
     */
    public Group(User user, String name) {
        this.user = user;
        this.name = name;
    }

    /**
     *
     * @param user
     * @param name
     * @param description
     * @param userGroups
     */
    public Group(User user, String name, String description, Set userGroups) {
       this.user = user;
       this.name = name;
       this.description = description;
       this.userGroups = userGroups;
    }
   
    /**
     *
     * @return
     */
    public Integer getId() {
        return this.id;
    }
    
    /**
     *
     * @param id
     */
    public void setId(Integer id) {
        this.id = id;
    }

    /**
     *
     * @return
     */
    public User getUser() {
        return this.user;
    }
    
    /**
     *
     * @param user
     */
    public void setUser(User user) {
        this.user = user;
    }

    /**
     *
     * @return
     */
    public String getName() {
        return this.name;
    }
    
    /**
     *
     * @param name
     */
    public void setName(String name) {
        this.name = name;
    }

    /**
     *
     * @return
     */
    public String getDescription() {
        return this.description;
    }
    
    /**
     *
     * @param description
     */
    public void setDescription(String description) {
        this.description = description;
    }
    
    /**
     *
     * @return
     */
    public Set<UserGroup> getUserGroups() {
        return this.userGroups;
    }
    
    /**
     *
     * @return
     */
    @Transient
    public List getUserGroupsList() {
        List<UserGroup> tmp = new ArrayList<>(this.userGroups);
        Collections.sort(tmp,Collections.reverseOrder());
        return tmp;
    }
    
    /**
     *
     * @param userGroups
     */
    public void setUserGroups(Set userGroups) {
        this.userGroups = userGroups;
    }
    
    /**
     *
     * @return
     */
    @Transient
    public int getSubscriptionNumber() {
        
        return this.getSubscribers().size();
    }
    
    /**
     *
     * @return
     */
    @Transient
    public int getMembersNumber() {
        
        return this.getMembers().size();
    }
    
    /**
     *
     * @return
     */
    @Transient
    public int getInvitedNumber() {
        return this.getInvited().size();
    }

    /**
     *
     * @return
     */
    @Transient
    public List<User> getMembers() {
        Set<UserGroup> temp;
        List<User> result = new ArrayList<>();
        temp = new HashSet<>(this.userGroups);
        
        for(UserGroup tmp : temp){
            if(tmp.getSubscribed()+tmp.getInvited()== (byte)0 && this.user.getId()!=tmp.getUser().getId()){
                result.add(tmp.getUser());
            }
        }
        return result;
    }
    
    /**
     *
     * @return
     */
    @Transient
    public List<User> getInvited() {
        Set<UserGroup> temp;
        List<User> result = new ArrayList<>();
        temp = new HashSet<>(this.userGroups);
        
        for(UserGroup tmp : temp){
            if(tmp.getInvited()== (byte)1){
                result.add(tmp.getUser());
            }
        }
        return result;
    }
    
    /**
     *
     * @return
     */
    @Transient
    public List<User> getSubscribers() {
        Set<UserGroup> temp;
        List<User> result = new ArrayList<>();
        temp = new HashSet<>(this.userGroups);
        
        for(UserGroup tmp : temp){
            if(tmp.getSubscribed()== (byte)1){
                result.add(tmp.getUser());
            }
        }
        temp.clear();
        return result;
    }
    
    /**
     *
     * @param t
     * @return
     */
    @Override
    public int compareTo(Object t) {
        Group g = (Group) t;
        return this.getName().compareTo((g.getName()));         
    }

    /**
     *
     * @return
     */
    @Override
    public int hashCode() {
        int hash = 7;
        hash = 71 * hash + Objects.hashCode(this.name);
        return hash;
    }
    
    /**
     *
     * @param t
     * @return
     */
    @Override
    public boolean equals(Object t) {
        Group g = (Group) t;
        return this.getName().equals(g.getName());
    }

    /**
     *
     * @return
     */
    @Override
    public String toString (){
        String result = "";
        result+= "Id:"+this.getId()+", Name:"+this.getName()+", Description:"+this.getDescription();
        return result;
    }

}


